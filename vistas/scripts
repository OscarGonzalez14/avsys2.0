select a.monto_abono,a.forma_pago,v.tipo_venta,a.fecha_abono,a.numero_venta,c.numero_venta,c.monto,c.saldo,c.tipo_credito from abonos as a inner join creditos as c on c.numero_venta=a.numero_venta inner join ventas as v on c.numero_venta=v.numero_venta;



select p.id_paciente,date_format(max(a.fecha_abono),'%d-%m-%Y') as fecha_abono,a.monto_abono,datediff(now(), max(a.fecha_abono)) as estado,c.saldo from abonos as a inner join creditos as c on a.numero_venta=c.numero_venta inner join pacientes as p on  c.id_paciente=p.id_paciente where p.id_paciente=111 and c.tipo_credito='Descuento en Planilla' group by p.id_paciente;
